# Детектирование лиц

| [Документация на английском](https://github.com/DmitryRyumin/Liberty/tree/master/liberty/modules/facesdet) |
| --- |

## Аргументы командной строки

| Аргумент&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | Тип | Описание | Допустимые значения |
| -------------------------- | ---  | -------- | ------------------- |
| command | str | Язык<br>`Значение по умолчанию: en` | `en`<br>`ru` |
| --file | str | Путь к фото/видео файлу или каталогу с фото файлами<br>`Значение по умолчанию: 0` | - |
| --config | str | Путь к конфигурационному файлу | - |
| --frames_to_update | int | Через какое количество шагов проверять конфигурационный файл (работает при `--automatic_update`)<br>`Значение по умолчанию: 25` | От `0` до `∞` |
| --automatic_update | bool | Автоматическая проверка конфигурационного файла в момент работы программы (работает при заданном `--config`) | Без значений |
| --no_clear_shell | bool | Не очищать консоль перед выполнением | Без значений |

## [Конфигурационный файл](https://github.com/DmitryRyumin/Liberty/blob/master/liberty/configs/facesdet.json)

### Параметры

| Параметр `json` | Тип | Описание | Допустимые значения |
| ---------------- | ---  | -------- | ------------------- |
| hide_metadata | bool | Скрытие метаданных | - |
| window_name | str | Имя окна | - |
| method | str | Метод детекции лиц | `opencv_dnn` |
| dnn | str | Тип нейронной сети | `tf`<br>`caffe` |
| size | dict | Размер изображения для нейронной сети<br>`Рекомендуется: 300×300` | - |
| resize | dict | Размер окна для масштабирования | От `100` до `1920` |
| switch_text_color | dict | Цвет текстов уведомлений об ошибках при переключении фото | От `0` до `255` |
| switch_size | int | Размер шрифта уведомлений об ошибках при переключении фото | От `1` до `60` |
| switch_stroke | int | Ширина обводки уведомлений об ошибках при переключении фото | От `0` до `4` |
| switch_stroke_color | int | Цвет обводки текста уведомлений об ошибках при переключении фото | От `0` до `255` |
| info_text_color | dict | Цвет текстов информационных уведомлений | От `0` до `255` |
| info_background_color | dict | Цвет фона информационных уведомлений | От `0` до `255` |
| info_size | int | Размер шрифта информационных уведомлений | От `1` до `60` |
| info_stroke | int | Ширина обводки текста информационных уведомлений | От `0` до `4` |
| info_stroke_color | int | Цвет обводки текста информационных уведомлений | От `0` до `255` |
| error_text_color | dict | Цвет текстов уведомлений об ошибках | От `0` до `255` |
| error_background_color | dict | Цвет фона уведомлений об ошибках | От `0` до `255` |
| error_size | int | Размер шрифта уведомлений об ошибках | От `1` до `60` |
| error_stroke | int | Ширина обводки текста уведомлений об ошибках | От `0` до `4` |
| error_stroke_color | int | Цвет обводки текста уведомлений об ошибках | От `0` до `255` |
| repeat_text_color | dict | Цвет текста повтора воспроизведения | От `0` до `255` |
| repeat_background_color | dict | Цвет фона повтора воспроизведения | От `0` до `255` |
| repeat_size | int | Размер шрифта текста повтора воспроизведения | От `1` до `120` |
| repeat_stroke | int | Ширина обводки текста повтора воспроизведения | От `0` до `4` |
| repeat_stroke_color | int | Цвет обводки текста повтора воспроизведения | От `0` до `255` |
| labels_base_coords | int | Начальные координаты верхних левых информационных уведомлений | От `0` до `100` |
| labels_padding | int | Внутренний отступ для всех текстов уведомлений | От `0` до `30` |
| labels_distance | int | Расстояние между текстами | От `0` до `15` |
| clear_image_buffer | bool | Очистка буфера с изображением | - |
| real_time | bool | Воспроизведение фото/видеопотока с реальным количеством FPS | - |
| repeat | bool | Повторение воспроизведения видеопотока | - |
| fps | int | Пользовательский FPS<br>`"real_time" = true` | От `0` до `60` |
| show_labels | bool | Отображение надписей в окне воспроизведения | - |
| face_rectangle | bool | Отображение ограничивающих прямоугольников детектированных лиц | - |
| conf_face_threshold | float | Доверительный порог детекции лиц | От `0.0` до `1.0` |
| draw_precent | bool | Отображение процентов рядом с каждым детектированным лицом<br>`"face_rectangle" = true` | - |
| face_rectangle_outline_color | dict | Цвет рамки ограничивающих прямоугольников детектированных лиц<br>`"face_rectangle" = true` | От `0` до `255` |
| face_rectangle_outline_size | int | Толщина рамки ограничивающих прямоугольников детектированных лиц<br>`"face_rectangle" = true` | От `1` до `10` |
| face_rectangle_background_color | dict | Цвет фона ограничивающих прямоугольников детектированных лиц<br>`"face_rectangle" = true` | От `0` до `255` |
| padding_face | dict | Внутренние отступы ограничивающих прямоугольников детектированных лиц<br>`"face_rectangle" = true` | От `1` до `100` |
| face_text_color | dict | Цвет текстов процентов для детектированных лиц<br>`"face_rectangle" = true` и `"draw_precent" = true` | От `0` до `255` |
| face_background_color | dict | Цвет фона процентов для детектированных лиц<br>`"face_rectangle" = true` и `"draw_precent" = true` | От `0` до `255` |
| face_size | int | Размер шрифта процентов для детектированных лиц<br>`"face_rectangle" = true` и `"draw_precent" = true` | От `1` до `60` |
| face_stroke | int | Ширина обводки текстов процентов для детектированных лиц<br>`"face_rectangle" = true` и `"draw_precent" = true` | От `0` до `4` |
| face_stroke_color | dict | Цвет обводки текстов процентов для детектированных лиц<br>`"face_rectangle" = true` и `"draw_precent" = true` | От `0` до `255` |
| face_padding | int | Внутренний отступ текстов процентов<br>`"face_rectangle" = true` и `"draw_precent" = true` | От `0` до `30` |
| face_distance | int | Расстояние между текстами процентов и ограничивающих прямоугольникоа найденных лиц<br>`"face_rectangle" = true` и `"draw_precent" = true` | От `0` до `15` |

### Горячие клавиши

| Клавиши | Сценарий |
| ------- | -------- |
| `esc` | Закрытие окна приложения |
| `r` | Повторение воспроизведения видеопотока |
| `> (стрелка вправо)` | Переключение на следующий фото файл |
| `> (стрелка влево)` | Переключение на предыдующий фото файл |

<h4 align="center"><span style="color:#EC256F;">Примеры</span></h4>

---

>  **Примечание!** Поддерживаемые форматы

| Видео | Фото | Каталоги |
| ----- | ---- | -------- |
| `mp4` и `avi` | `png` и `jpg` | С `png` и `jpg` файлами |

---

1. Детектирование лиц на воспроизводимом видео файле с автоматическим обновлением конфигурационного файла (Язык: `Русский`)

    > CMD
    >
    > ```shell script
    > liberty_facesdet ru --file путь_к_видео_файлу --config путь_к_конфигурационному_файлу --automatic_update
    > ```

2. Детектирование лиц на стриминге WEB-камеры с автоматическим обновлением конфигурационного файла каждые 50 кадров (Язык: `Английский`)

    > CMD
    >
    > ```shell script
    > liberty_facesdet en --file 0 --config путь_к_конфигурационному_файлу --automatic_update --frames_to_update 50
    > ```

3. Детектирование лиц на воспроизводимых фото файлах с автоматическим обновлением конфигурационного файла (Язык: `Русский`)

    > CMD
    >
    > ```shell script
    > liberty_facesdet ru --file путь_к_каталогу_фото_файлов --config путь_к_конфигурационному_файлу --automatic_update
    > ```
